apply plugin: 'java'

sourceSets.main.java.srcDirs += "JWalk11.jar.decompiled"
sourceSets {
    main {
        resources {
            srcDirs = ["JWalk11.jar.decompiled"]
            includes = ["**/*.gif"]
        }
    }
}

sourceCompatibility = JavaVersion.VERSION_21
targetCompatibility = JavaVersion.VERSION_21

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

tasks.withType(Test) {
    systemProperty 'file.encoding', 'UTF-8'
}

tasks.withType(JavaExec) {
    systemProperty 'file.encoding', 'UTF-8'
}

jar {
    manifest {
        attributes "Main-Class": "org.jwalk.tool.JWalkTester"
    }

    archiveClassifier = 'uber'

    duplicatesStrategy = DuplicatesStrategy.EXCLUDE

    from {
        configurations.runtimeClasspath.collect {
            it.isDirectory() ? it : zipTree(it)
        }
    }
    exclude 'META-INF/*.RSA'
    exclude 'META-INF/*.SF'
    exclude 'META-INF/*.DSA'
}
